using System;
using System.Collections.Generic;
using System.Linq;

namespace LinQ
{
    class Program
    {
        static void Main(string[] args)
        {
            Hospital hospital = new Hospital();

            hospital.BeginWork();
        }
    }

    class Hospital
    {
        private readonly List<Client> _clients = new List<Client>();
        private readonly Analyzer _analyzer = new Analyzer();
        private readonly int _numberPlaces = 10;

        public void BeginWork()
        {
            bool isWork = true;

            CreateClients();

            while (isWork)
            {
                Console.Clear();
                DrawInterfaces();
                string action = Console.ReadLine();

                switch (action)
                {
                    case "1":
                        _analyzer.ShowFullNameSort(_clients);
                        break;

                    case "2":
                        _analyzer.ShowAgeSort(_clients);
                        break;

                    case "3":
                        _analyzer.ShowDiseaseSort(_clients);
                        break;

                    case "4":
                        isWork = false;
                        break;

                    default:
                        Console.WriteLine("Криворукий.");
                        break;
                }

                Console.ReadKey();
            }
        }

        private void DrawInterfaces()
        {
            DrawClients();
            DrawMenu();
        }

        private void DrawMenu()
        {
            Console.SetCursorPosition(0, 0);
            Console.WriteLine("Картотека пациентов:\n\n 1 - Сортировка по ФИО.\n 2 - Сортировка по возрасту.\n 3 - Показать клиентов определенным заболеванием.\n 4 - Закончить работу.");
            Console.Write("\nВыбор действия: ");
        }

        private void DrawClients()
        {
            int positionClientsX = 55;
            int positionClientsY = 2;

            Console.SetCursorPosition(positionClientsX, 0);
            Console.WriteLine(" Картотека лечащихся: ФИО : Взраст : Заболевание\n");

            for (int i = 0; i < _clients.Count; i++)
            {
                Console.SetCursorPosition(positionClientsX, positionClientsY++);
                _clients[i].Draw();
            }
        }

        private void CreateClients()
        {
            Console.WriteLine("Заполняем койко-места: ");

            for (int i = 0; i < _numberPlaces; i++)
            {
                Console.Write("Введите диагноз больного: ");
                string disaese = Console.ReadLine();

                if (disaese == "")
                {
                    Console.WriteLine("Здоровых не принимаем.");
                    i--;
                }
                else
                {
                    _clients.Add(new Client(disaese));
                }
            }
        }
    }

    class Analyzer
    {
        public void ShowFullNameSort(List<Client> clients)
        {
            var persoons = clients.OrderBy(persoon => persoon.FullName).ToList();
            DrawResult(persoons, "Сортировка по ФИО: ");
        }

        public void ShowAgeSort(List<Client> clients)
        {
            var persoons = clients.OrderBy(persoon => persoon.Age).ToList();
            DrawResult(persoons, "Сортировка по возрасту: ");
        }

        public void ShowDiseaseSort(List<Client> clients)
        {
            Console.Write(" Введите диагноз: ");
            string disease = Console.ReadLine().ToLower();
            var persoons = clients.Where(persoon => persoon.Disease.ToLower() == disease).ToList();
            DrawResult(persoons, $"Клиенты с диагнозом - {disease}: ");
        }

        private void DrawResult(List<Client> result, string text)
        {
            Console.WriteLine($"\n\n{text}\n");

            foreach (var persoon in result)
            {
                persoon.Draw();
                Console.WriteLine();
            }
        }
    }

    class Client
    {
        private static readonly Random _random = new Random();
        private readonly StringArrayStorage _stringArrayStorage = new StringArrayStorage();
        public string FullName { get; private set; }
        public int Age { get; private set; }
        public string Disease { get; private set; }

        public Client(string disease)
        {
            int minimumAge = 20;
            int maximumAge = 100;

            FullName = AlignText(Get(_stringArrayStorage.Surnames)) + AlignText(Get(_stringArrayStorage.Names)) + AlignText(Get(_stringArrayStorage.Patronymics));
            Age = _random.Next(minimumAge, maximumAge);
            Disease = disease;
        }

        public void Draw() => Console.Write($"{FullName} : {Age} : {Disease}");

        private string AlignText(string word)
        {
            char sing = ' ';
            int numberSigns = 12;
            int number = numberSigns - word.Length;

            for (int i = 0; i < number; i++)
                word += sing;

            return word;
        }

        private string Get(string[] wordList)
        {
            if (wordList != null)
                return wordList[_random.Next(0, wordList.Length)] + " ";
            else
                return null;
        }
    }

    class StringArrayStorage
    {
        public string[] Names { get; private set; } = { "Иван", "Степан", "Баклан", "Колыван", "Диван", "Урал", "Денис", };
        public string[] Patronymics { get; private set; } = { "Иванович", "Степанович", "Бакланович", "Колыванович", "Диванович", "Урал", "Денисович", };
        public string[] Surnames { get; private set; } = { "Иванов", "Степанов", "Бакланов", "Колыванов", "Диванов", "Уралов", "Денисов", };
    }
}
